{"version":3,"file":"547-709106.js","mappings":"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","sources":["webpack://TopWritePlugins.theme-default/./src/scss/body.module.scss","webpack://TopWritePlugins.theme-default/./src/scss/summary.module.scss","webpack://TopWritePlugins.theme-default/./.topwrite/use-config.ts","webpack://TopWritePlugins.theme-default/./src/components/summary.tsx","webpack://TopWritePlugins.theme-default/./src/lib/use-sidebar.tsx","webpack://TopWritePlugins.theme-default/./src/components/sidebar.tsx","webpack://TopWritePlugins.theme-default/./src/scss/main.module.scss","webpack://TopWritePlugins.theme-default/./src/components/document.tsx","webpack://TopWritePlugins.theme-default/./src/components/body.tsx","webpack://TopWritePlugins.theme-default/./src/scss/head.module.scss","webpack://TopWritePlugins.theme-default/./src/components/header.tsx","webpack://TopWritePlugins.theme-default/./src/components/root.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"body\":\"body--4cb30f26\",\"sidebar\":\"sidebar--92cdcd4d\",\"content\":\"content--2d657e4b\",\"copyright\":\"copyright--2aa57f2d\",\"mask\":\"mask--3fa1e0fc\",\"open\":\"open--76262ba2\"};","// extracted by mini-css-extract-plugin\nexport default {\"summary\":\"summary--54538abb\",\"part\":\"part--2f00bd41\",\"title\":\"title--3df1ba16\",\"item\":\"item--9cbf6482\",\"whole\":\"whole--9f70f484\",\"space\":\"space--8603ccbf\",\"text\":\"text--59d9f9de\",\"selected\":\"selected--3b82c009\",\"active\":\"active--c30e4dc0\",\"disabled\":\"disabled--60b293f5\",\"open\":\"open--57a75e6f\"};","import { BaseConfig, Config, useBook } from 'topwrite';\r\nimport { Config as ConfigType } from './config';\r\n\r\ndeclare const PLUGIN_NAME: string;\r\n\r\ndeclare module 'topwrite' {\r\n    export interface HookContext {\r\n        getConfig(): BaseConfig<ConfigType>;\r\n    }\r\n}\r\n\r\nexport function getPluginConfig(config: Config): BaseConfig<ConfigType> {\r\n\r\n    const schema = require('../config.json');\r\n\r\n    return config.getPluginConfig(PLUGIN_NAME, schema);\r\n}\r\n\r\nexport default function useConfig() {\r\n    const { config } = useBook();\r\n\r\n    return getPluginConfig(config);\r\n};\r\n","import { Catalog, CatalogProps, Link, useIntl } from 'topwrite';\r\nimport { useCallback, useEffect, useState } from 'react';\r\nimport style from '../scss/summary.module.scss';\r\nimport { BsCaretDownFill } from '@react-icons/all-files/bs/BsCaretDownFill';\r\nimport { BsCaretRightFill } from '@react-icons/all-files/bs/BsCaretRightFill';\r\nimport classNames from 'classnames';\r\nimport useConfig from '@@/use-config';\r\n\r\nconst Item: CatalogProps['itemComponent'] = ({ item, active, disabled, activeDescendant, children }) => {\r\n    const config = useConfig();\r\n\r\n    const [open, setOpen] = useState(() => {\r\n        return config.getValue('auto_open') && item.level.getDepth() === 1 || activeDescendant;\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (!open && active) {\r\n            setOpen(true);\r\n        }\r\n    }, [active]);\r\n\r\n    useEffect(() => {\r\n        if (!open && activeDescendant) {\r\n            setOpen(true);\r\n        }\r\n    }, [activeDescendant]);\r\n\r\n    const handleSpaceClick = useCallback(() => {\r\n        if (children) {\r\n            setOpen(!open);\r\n        }\r\n    }, [open, children]);\r\n\r\n    return <li className={classNames({ [style.open]: open })}>\r\n        <div className={classNames(style.item, {\r\n            [style.active]: active,\r\n            [style.disabled]: disabled,\r\n        })}>\r\n            <div className={style.whole} />\r\n            <span className={style.space} onClick={handleSpaceClick}>\r\n                {children && (open ? <BsCaretDownFill size={12} /> : <BsCaretRightFill size={12} />)}\r\n            </span>\r\n            <Link className={style.text} to={item}>\r\n                {item.title}\r\n            </Link>\r\n        </div>\r\n        {children}\r\n    </li>;\r\n};\r\n\r\nconst Part: CatalogProps['partComponent'] = ({ part, children }) => {\r\n\r\n    const intl = useIntl();\r\n\r\n    return <div className={style.part}>\r\n        <div className={style.title}>\r\n            {part.title || intl.formatMessage({ defaultMessage: '未命名分组' })}\r\n        </div>\r\n        {children}\r\n    </div>;\r\n};\r\n\r\nexport default function Summary() {\r\n\r\n    return <div className={style.summary}>\r\n        <Catalog\r\n            partComponent={Part}\r\n            itemComponent={Item}\r\n        />\r\n    </div>;\r\n}\r\n","import { createContext, ReactNode, useContext, useState } from 'react';\r\n\r\ninterface SidebarContentProps {\r\n    open: boolean;\r\n    setOpen: (open: boolean) => void;\r\n}\r\n\r\nexport const SidebarContext = createContext<SidebarContentProps | undefined>(undefined);\r\n\r\ninterface Props {\r\n    readonly children: ReactNode;\r\n}\r\n\r\nexport function SidebarProvider({ children }: Props) {\r\n\r\n    const [open, setOpen] = useState(false);\r\n\r\n    return <SidebarContext.Provider value={{ open, setOpen }}>\r\n        {children}\r\n    </SidebarContext.Provider>;\r\n}\r\n\r\nexport function useSidebar() {\r\n    const context = useContext(SidebarContext);\r\n\r\n    if (!context) {\r\n        throw new Error();\r\n    }\r\n\r\n    return context;\r\n}\r\n","import style from '../scss/body.module.scss';\r\nimport Summary from '@/components/summary';\r\nimport { PoweredBy } from 'topwrite';\r\nimport { useSidebar } from '@/lib/use-sidebar';\r\nimport classNames from 'classnames';\r\n\r\nexport default function Sidebar() {\r\n\r\n    const { setOpen, open } = useSidebar();\r\n\r\n    return <>\r\n        <div className={classNames(style.sidebar, {\r\n            [style.open]: open\r\n        })}>\r\n            <div className={style.content}>\r\n                <Summary />\r\n                <PoweredBy className={style.copyright} />\r\n            </div>\r\n        </div>\r\n        {open && <div onClick={() => setOpen(false)} className={style.mask} />}\r\n    </>;\r\n}\r\n","// extracted by mini-css-extract-plugin\nexport default {\"main\":\"main--6aaec551\",\"toolbar\":\"toolbar--af3e5b9e\",\"content\":\"content--dbbad732\",\"navigation\":\"navigation--93943883\",\"prev\":\"prev--8f062b74\",\"next\":\"next--1623c556\"};","import {\r\n    Link,\r\n    useIntl,\r\n    useNextArticle,\r\n    usePrevArticle,\r\n    Article\r\n} from 'topwrite';\r\nimport style from '../scss/main.module.scss';\r\n\r\nexport default function Document() {\r\n\r\n    const intl = useIntl();\r\n\r\n    const prevArticle = usePrevArticle();\r\n    const nextArticle = useNextArticle();\r\n\r\n    return <div className={style.main}>\r\n        <Article\r\n            className={style.content}\r\n            footer={\r\n                <div className={style.navigation}>\r\n                    {prevArticle && <span className={style.prev}>\r\n                        {intl.formatMessage({ defaultMessage: '上一篇' })}:<Link\r\n                        to={prevArticle}>{prevArticle.title}</Link>\r\n                    </span>}\r\n                    {nextArticle && <span className={style.next}>\r\n                        {intl.formatMessage({ defaultMessage: '下一篇' })}:<Link\r\n                        to={nextArticle}>{nextArticle.title}</Link>\r\n                    </span>}\r\n                </div>}\r\n        />\r\n    </div>;\r\n}\r\n","import { useEffect } from 'react';\r\nimport style from '../scss/body.module.scss';\r\nimport Sidebar from '@/components/sidebar';\r\nimport { history, useArticle, useBook, useFile } from 'topwrite';\r\nimport Document from '@/components/document';\r\n\r\nexport default function Body() {\r\n\r\n    const file = useFile();\r\n    const { summary } = useBook();\r\n\r\n    const article = useArticle();\r\n\r\n    useEffect(() => {\r\n        if (!article) {\r\n            const firstPath = summary.getFirstPath();\r\n            if (firstPath) {\r\n                history.replace(file.relative(firstPath));\r\n            }\r\n        }\r\n    }, [article]);\r\n\r\n    if (!article) {\r\n        return null;\r\n    }\r\n\r\n    return <div className={style.body}>\r\n        <Sidebar />\r\n        <Document />\r\n    </div>;\r\n}\r\n","// extracted by mini-css-extract-plugin\nexport default {\"head\":\"head--058b913b\",\"menu\":\"menu--d0b4dcbb\",\"title\":\"title--18735434\",\"navs\":\"navs--be057733\",\"search\":\"search--9199f203\"};","import style from '../scss/head.module.scss';\r\nimport { Link, Logo, useBook, useFile, useTitle, useWindowSize } from 'topwrite';\r\nimport path from 'path';\r\nimport useConfig from '@@/use-config';\r\nimport { DocSearch } from '@topwrite/docsearch';\r\nimport { BsList } from '@react-icons/all-files/bs/BsList';\r\nimport { useSidebar } from '@/lib/use-sidebar';\r\nimport { useEffect } from 'react';\r\n\r\nexport default function Header() {\r\n\r\n    const title = useTitle();\r\n    const { summary } = useBook();\r\n    const file = useFile();\r\n    const config = useConfig();\r\n    const navs = config.getValue('navs');\r\n\r\n    const windowSize = useWindowSize();\r\n\r\n    const { setOpen, open } = useSidebar();\r\n\r\n    useEffect(() => {\r\n        setOpen(false);\r\n    }, [windowSize, file.path]);\r\n\r\n    return <div className={style.head}>\r\n        {windowSize == 'mobile' && <div onClick={() => setOpen(!open)} className={style.menu}>\r\n            <BsList />\r\n        </div>}\r\n        <Link className={style.title} to='.'>\r\n            <Logo />\r\n            <span>{title}</span>\r\n        </Link>\r\n        <div className={style.navs}>\r\n            {windowSize == 'desktop' && navs.map((nav, index) => {\r\n                if (!nav.url.startsWith('http') && path.extname(nav.url) === '.md') {\r\n                    const linkArticle = summary.getArticle(article => article.ref === nav.url);\r\n                    if (linkArticle) {\r\n                        return <Link key={index} to={linkArticle}>{nav.title}</Link>;\r\n                    }\r\n                }\r\n                return <a key={index} href={nav.url} target='_blank'>{nav.title}</a>;\r\n            })}\r\n        </div>\r\n        <div className={style.search}>\r\n            <DocSearch />\r\n        </div>\r\n    </div>;\r\n}\r\n","import Body from '@/components/body';\r\nimport Header from '@/components/header';\r\nimport '../scss/root.scss';\r\nimport Loading from 'react-loading-bar';\r\nimport { useSelector, useThemeConfig } from 'topwrite';\r\nimport { SidebarProvider } from '@/lib/use-sidebar';\r\n\r\nexport default function Root() {\r\n\r\n    const { loading } = useSelector('page');\r\n    const { primaryColor } = useThemeConfig();\r\n\r\n    return <SidebarProvider>\r\n        <Loading show={loading} color={primaryColor} />\r\n        <Header />\r\n        <Body />\r\n    </SidebarProvider>;\r\n}\r\n"],"names":["useConfig","config","useBook","schema","getPluginConfig","Item","item","active","disabled","activeDescendant","children","open","setOpen","useState","getValue","level","getDepth","useEffect","handleSpaceClick","useCallback","className","onClick","BsCaretDownFill","size","BsCaretRightFill","Link","to","title","Part","part","intl","useIntl","formatMessage","defaultMessage","Summary","Catalog","partComponent","itemComponent","SidebarContext","createContext","undefined","SidebarProvider","Provider","value","useSidebar","context","useContext","Error","Sidebar","PoweredBy","Document","prevArticle","usePrevArticle","nextArticle","useNextArticle","Article","footer","Body","file","useFile","summary","article","useArticle","firstPath","getFirstPath","history","relative","Header","useTitle","navs","windowSize","useWindowSize","path","BsList","Logo","map","nav","index","url","startsWith","linkArticle","getArticle","ref","href","target","Root","loading","useSelector","primaryColor","useThemeConfig","show","color"],"sourceRoot":""}